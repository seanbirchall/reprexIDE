[{"name":"app.R","content":"\r\nsource(\"R/global.R\")\r\n\r\noptions(launch.browser = FALSE)\r\n\r\nui <- bslib::page(\r\n  \r\n  shinyjs::useShinyjs(),\r\n  \r\n  title = \"webR IDE\",\r\n  \r\n  theme = bslib::bs_theme(\r\n    preset = \"flatly\",\r\n    font_scale = 0.95, \r\n    `enable-rounded` = FALSE, \r\n    `enable-transitions` = FALSE\r\n  ),\r\n  \r\n  shinybusy::add_busy_spinner(\r\n    timeout = 500,\r\n    spin = \"half-circle\",\r\n    color = \"#f39c12\",\r\n    position = \"bottom-left\",\r\n    height = \"10%\",\r\n    width = \"10%\"\r\n  ),\r\n  \r\n  shiny::tags$head(\r\n    shiny::tags$link(\r\n      rel = \"stylesheet\", href = \"style.css\"\r\n    )\r\n  ),\r\n  \r\n  shiny::tags$body(\r\n    shiny::tags$div(\r\n      class = \"split\",\r\n      shiny::tags$div(\r\n        id = \"pane-code\",\r\n        shiny::tags$div(\r\n          id = \"pane-editor\",\r\n          ui_editor(\r\n            id = \"editor\"\r\n          )\r\n        ),\r\n        shiny::tags$div(\r\n          id = \"pane-console\",\r\n          ui_console(\r\n            id = \"console\"\r\n          )\r\n        )\r\n      ),\r\n      shiny::tags$div(\r\n        id = \"pane-control\",\r\n        ui_controls(\r\n          id = \"controls\"\r\n        )\r\n      )\r\n    )\r\n  ),\r\n  \r\n  shiny::includeScript(\r\n    path = \"https://cdnjs.cloudflare.com/ajax/libs/split.js/1.6.2/split.min.js\"\r\n  ),\r\n  shiny::includeScript(\r\n    path = \"https://cdn.jsdelivr.net/npm/js-md5@0.8.3/src/md5.min.js\"\r\n  ),\r\n  shiny::includeScript(\r\n    path = \"www/custom.js\"\r\n  )\r\n  \r\n)\r\n\r\nserver <- function(input, output, session){\r\n  \r\n  # values to pass to components\r\n  ide <- shiny::reactiveValues(\r\n    # global\r\n    envir = NULL,\r\n    pak = NULL,\r\n    view = NULL,\r\n    # code\r\n    hash = NULL,\r\n    evals = NULL,\r\n    code = NULL,\r\n    # navigation\r\n    tab = \"environment\",\r\n    tab_modal = \"structure\",\r\n    menu = \"data\",\r\n    tab_data = \"table\",\r\n    tab_visual = \"viz1\",\r\n    tab_model = \"mod1\",\r\n    # table selections\r\n    df_selected = NULL,\r\n    obj_selected = NULL,\r\n    # explore\r\n    df = NULL,\r\n    df_vars = NULL\r\n  )\r\n  \r\n  # check for code\r\n  observe({\r\n    query <- parseQueryString(session$clientData$url_search)\r\n    if (!is.null(query[['code']])) {\r\n      message(\"Checking Hash \")\r\n \r\n    }\r\n  })\r\n  \r\n  server_editor(\r\n    id = \"editor\",\r\n    ide = ide\r\n  )\r\n  \r\n  server_console(\r\n    id = \"console\",\r\n    ide = ide\r\n  )\r\n  \r\n  server_controls(\r\n    id = \"controls\",\r\n    ide = ide\r\n  )\r\n  \r\n  server_environment(\r\n    id = \"environment\",\r\n    ide = ide\r\n  )\r\n  \r\n  server_explore(\r\n    id = \"explore\",\r\n    ide = ide\r\n  )\r\n  \r\n  server_viewer(\r\n    id = \"viewer\",\r\n    ide = ide\r\n  )\r\n  \r\n  do <- list(\r\n    code = c(\"iris %>%\\n mutate(n=n())\"),\r\n    enviornment = list(\r\n      objects = c(\"\"),\r\n      packages = c(\"dplyr\", \"tidyr\", \"readxl\")\r\n    ),\r\n    viewer = c(\"\"),\r\n    explore = c(\"\"),\r\n    description = c(\"\"),\r\n    id = c(\"\"),\r\n    user = c(\"\")\r\n  )\r\n  \r\n  shiny::observeEvent(input$share, {\r\n    \r\n    shinyjs::runjs(\r\n      \"var editor = ace.edit('editor-Ace');\r\n       var editorValue = editor.getValue();\r\n       var editorHash = md5(editorValue);\r\n       \r\n       // previous hash\r\n       var previousEditorHash = Shiny.shinyapp.$values.editorHash;\r\n       \r\n       if(editorHash !== previousEditorHash && editorValue.length > 1){\r\n        fetch('https://httpbin.org/post', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify(\r\n            {\r\n              'code': editorValue,\r\n              'id': editorHash\r\n            }\r\n          )\r\n        })\r\n        .then(response => response.json())\r\n        .then(data => {\r\n          Shiny.setInputValue('editorHash', editorHash);\r\n        })\r\n        .catch(error => console.error('Error:', error));\r\n       }\r\n      \"\r\n    )\r\n    \r\n    shiny::showModal(\r\n      shiny::modalDialog(\r\n        title = \"IDE URL\",\r\n        shiny::fluidRow(\r\n          shiny::column(\r\n            width = 9,\r\n            shiny::textInput(\r\n              inputId = \"share_text\",\r\n              label = NULL,\r\n              width = \"100%\",\r\n              value = paste0(\"https://www.scrapeable.com/?ide=\", ide$hash)\r\n            )\r\n          ),\r\n          shiny::column(\r\n            width = 3,\r\n            shiny::actionButton(\r\n              inputId = \"share_ide\",\r\n              label = \"Copy URL\",\r\n              width = \"100%\",\r\n              icon = shiny::icon(\r\n                \"link\"\r\n              )\r\n            )\r\n          )\r\n        ),\r\n        easyClose = TRUE,\r\n        footer = NULL,\r\n        size = \"l\"\r\n      )\r\n    )\r\n    \r\n  })\r\n  \r\n}\r\n\r\nshiny::shinyApp(ui = ui, server = server)\r\n","type":"text"},{"name":"R/console.R","content":"ui_console <- function(id=\"console\"){\r\n  ns <- shiny::NS(id)\r\n  \r\n  shiny::tagList(\r\n    bslib::card(\r\n      height = \"100%\",\r\n      full_screen = TRUE,\r\n      fill = TRUE,\r\n      bslib::card_header(\r\n        style = \"padding: 0px; background-color: #eee;\",\r\n        shiny::fluidRow(\r\n          class = \"m-0\",\r\n          align = \"right\",\r\n          column(\r\n            width = 12,\r\n            align = \"right\",\r\n            class = \"m-0\",\r\n            style = \"padding: 0px;\",\r\n            shiny::actionButton(\r\n              inputId = ns(\"Clear\"),\r\n              label = NULL,\r\n              style = \"width: 45px; font-size: 80%; padding: 0px; border: 1px solid #f2f2f2; background-color: #ffc107;\",\r\n              icon = shiny::icon(\r\n                \"broom\"\r\n              )\r\n            ) %>%\r\n              bslib::tooltip(\"Clear Console\", placement = \"bottom\")\r\n          )\r\n        )\r\n      ),\r\n      bslib::card_body(\r\n        style = \"padding: 0px; margin-left: 10px;\",\r\n        shiny::uiOutput(\r\n          outputId = ns(\"console\")\r\n        )\r\n      )\r\n    )\r\n  )\r\n  \r\n}\r\n\r\nserver_console <- function(id=\"console\", ide){\r\n  \r\n  shiny::moduleServer(\r\n    id,\r\n    function(input, output, session){\r\n      ns <- session$ns\r\n      \r\n      # observe input state\r\n      observeEvent(input$Clear, {\r\n        message(\"Clear Code\")\r\n        ide$evals <- NULL\r\n      })\r\n      \r\n      # ui outputs\r\n      output$console <- shiny::renderUI({\r\n        shiny::tags$div(\r\n          style = \"line-height: normal; letter-spacing: -0.00164474px; font-size: 12px; font-kerning: none;\",\r\n          \r\n          lapply(seq_along(ide$evals), function(chunk){\r\n            gsub_terminal <- function(src){\r\n              base::paste0(\r\n                \"> \",\r\n                src\r\n              )\r\n            }\r\n            \r\n            src <- shiny::tags$span(\r\n              class = \"r-src\",\r\n              gsub_terminal(\r\n                ide$evals[[chunk]][[\"src\"]]\r\n              )\r\n            )\r\n            \r\n            \r\n            if(is.null(ide$evals[[chunk]][[\"msg\"]][[\"messages\"]])){\r\n              messages <- NULL\r\n            }else{\r\n              messages <- shiny::tags$span(class=\"r-message\", paste(ide$evals[[chunk]][[\"msg\"]][[\"messages\"]], collapse = \"\\n\"))\r\n            }\r\n            \r\n            \r\n            if(is.null(ide$evals[[chunk]][[\"msg\"]][[\"warnings\"]])){\r\n              warnings <- NULL\r\n            }else{\r\n              warnings <- shiny::tags$span(class=\"r-warning\", paste(ide$evals[[chunk]][[\"msg\"]][[\"warnings\"]], collapse = \"\\n\"))\r\n            }\r\n            \r\n            \r\n            if(is.null(ide$evals[[chunk]][[\"msg\"]][[\"errors\"]])){\r\n              errors <- NULL\r\n            }else{\r\n              errors <- shiny::tags$span(class=\"r-error\", paste(ide$evals[[chunk]][[\"msg\"]][[\"errors\"]], collapse = \"\\n\"))\r\n            }\r\n            \r\n            if(is.null(ide$evals[[chunk]][[\"output\"]])){\r\n              output <- NULL\r\n            }else{\r\n              output <- shiny::tags$span(class=\"r-output\", paste(ide$evals[[chunk]][[\"output\"]], collapse = \"\\n\"))\r\n            }\r\n            \r\n            tgs <- shiny::tagList(\r\n              src,\r\n              if(!is.null(src)){shiny::tags$br()},\r\n              messages,\r\n              if(!is.null(messages)){shiny::tags$br()},\r\n              warnings,\r\n              if(!is.null(warnings)){shiny::tags$br()},\r\n              errors,\r\n              if(!is.null(errors)){shiny::tags$br()},\r\n              output,\r\n              shiny::tags$br()\r\n            )\r\n            \r\n          })\r\n        )\r\n      })\r\n      \r\n    }\r\n    \r\n  )\r\n  \r\n}","type":"text"},{"name":"R/controls.R","content":"ui_controls <- function(id=\"controls\"){\r\n  ns <- shiny::NS(id)\r\n  \r\n  shiny::tagList(\r\n    shiny::tags$div(\r\n      style = \"height: 100vh; width: 100%; overflow: hidden;\",\r\n      shiny::fluidRow(\r\n        class = \"m-0\",\r\n        style = \"height: 100vh;\",\r\n        bslib::card(\r\n          height = \"100%\",\r\n          style = \"padding: 0px;\",\r\n          full_screen = FALSE,\r\n          fill = TRUE,\r\n          bslib::card_header(\r\n            style = \"padding: 0px; background-color: #eee;\",\r\n            shiny::fluidRow(\r\n              class = \"m-0\",\r\n              column(\r\n                width = 10,\r\n                align = \"left\",\r\n                style = \"padding: 0px;\",\r\n                shiny::actionButton(\r\n                  inputId = ns(\"tab_environment\"),\r\n                  label = \"Environment\",\r\n                  style = \"width: 80px; font-size: 12px; padding: 0px; border: 1px solid #f2f2f2; background-color: #eee; color: black; font-weight: 600;\"\r\n                ),\r\n                shiny::actionButton(\r\n                  inputId = ns(\"tab_viewer\"),\r\n                  label = \"Viewer\",\r\n                  style = \"width: 80px; font-size: 12px; padding: 0px; border: 1px solid #f2f2f2; background-color: #eee; color: black; font-weight: 600;\"\r\n                ),\r\n                shiny::actionButton(\r\n                  inputId = ns(\"tab_explore\"),\r\n                  label = \"Explore\",\r\n                  style = \"width: 80px; font-size: 12px; padding: 0px; border: 1px solid #f2f2f2; background-color: #eee; color: black; font-weight: 600;\"\r\n                )\r\n              ),\r\n              column(\r\n                width = 2,\r\n                align = \"right\",\r\n                style = \"padding: 0px;\",\r\n                shiny::actionButton(\r\n                  inputId = \"share\",\r\n                  label = \"Share\",\r\n                  style = \"width: 80px; font-size: 80%; padding: 0px; border: 1px solid #eee; background-color: #eee; color: black;\",\r\n                  icon = shiny::icon(\r\n                    \"share-nodes\"\r\n                  )\r\n                ) %>%\r\n                  bslib::tooltip(\"Create Link\", placement = \"bottom\")\r\n              )\r\n            )\r\n          ),\r\n          bslib::card_body(\r\n            style = \"padding: 0px; margin: 0px;\",\r\n            height = \"100%\",\r\n            uiOutput(ns(\"control\"))\r\n          )\r\n        )\r\n      )\r\n    )\r\n  )\r\n  \r\n}\r\n\r\nserver_controls <- function(id=\"controls\", ide){\r\n  \r\n  shiny::moduleServer(\r\n    id,\r\n    function(input, output, session){\r\n      ns <- session$ns\r\n\r\n      # observe input state\r\n      shiny::observeEvent(input$tab_environment, {\r\n        ide$tab <- \"environment\"\r\n      })\r\n      \r\n      shiny::observeEvent(input$tab_viewer, {\r\n        ide$tab <- \"viewer\"\r\n      })\r\n      \r\n      shiny::observeEvent(input$tab_explore, {\r\n        ide$tab <- \"explore\"\r\n      })\r\n      \r\n      shiny::observeEvent(ide$code, {\r\n        message(\"Watching Code\")\r\n        \r\n        ev <- ls(.GlobalEnv)\r\n        cl <- as.character(lapply(mget(ev, envir = .GlobalEnv), class))\r\n        df_envir <- data.frame(\r\n          Object = ev,\r\n          Class = cl\r\n        ) %>%\r\n          filter(!Object %in% c(\"server_console\", \"server_controls\", \"server_editor\", \"ui_console\", \"ui_controls\", \"ui_editor\", \"ui_environment\"))\r\n\r\n        ide$envir <- df_envir\r\n        \r\n        df_envir <- df_envir %>%\r\n          filter(grepl(\"data.frame|tbl|tbl_df|data.table\", Class, ignore.case = TRUE)) %>%\r\n          select(DataFrames = Object)\r\n        \r\n        ide$df <- dplyr::bind_rows(\r\n          ide$df,\r\n          df_envir\r\n        ) %>%\r\n          distinct(DataFrames)\r\n        \r\n        df_pak <- sessionInfo()[[\"otherPkgs\"]]\r\n        df_pak <- purrr::map_df(seq_along(df_pak), function(x){\r\n          data.frame(\r\n            Package = df_pak[[x]][[\"Package\"]],\r\n            Title = df_pak[[x]][[\"Title\"]],\r\n            Version = df_pak[[x]][[\"Version\"]]\r\n          )\r\n        })\r\n        \r\n        ide$pak <- df_pak\r\n        \r\n      }, ignoreInit = TRUE)\r\n      \r\n      shiny::observeEvent(ide$view, {\r\n        message(\"watching Viewer\")\r\n        \r\n        shinyjs::delay(1, shinyjs::click(id = \"tab_viewer\"))\r\n        \r\n      }, ignoreInit = TRUE)\r\n      \r\n      \r\n      # ui outputs\r\n      output$control <- shiny::renderUI({\r\n        \r\n        if(ide$tab == \"environment\"){\r\n          \r\n          ui_environment(\r\n            id = \"environment\"\r\n          )\r\n          \r\n        }else if(ide$tab == \"viewer\"){\r\n          \r\n          ui_viewer(\r\n            id = \"viewer\"\r\n          )\r\n          \r\n        }else if(ide$tab == \"explore\"){\r\n          \r\n          ui_explore(\r\n            id = \"explore\"\r\n          )\r\n          \r\n        }else if(ide$tab == \"help\"){\r\n          \r\n        }\r\n        \r\n      })\r\n      \r\n    }\r\n  )\r\n  \r\n}","type":"text"},{"name":"R/editor.R","content":"ui_editor <- function(id=\"editor\"){\r\n  ns <- shiny::NS(id)\r\n  \r\n  shiny::tagList(\r\n    bslib::card(\r\n      height = \"100%\",\r\n      full_screen = TRUE,\r\n      fill = TRUE,\r\n      bslib::card_header(\r\n        style = \"padding: 0px; background-color: #eee;\",\r\n        shiny::fluidRow(\r\n          class = \"m-0\",\r\n          column(\r\n            width = 12,\r\n            align = \"right\",\r\n            class = \"m-0\",\r\n            style = \"padding: 0px;\",\r\n            shiny::actionButton(\r\n              inputId = ns(\"Run\"),\r\n              label = NULL,\r\n              style = \"width: 45px; font-size: 80%; padding: 0px; border: 1px solid #f2f2f2; background-color: green;\",\r\n              icon = shiny::icon(\r\n                \"play\"\r\n              )\r\n            ) %>%\r\n              bslib::tooltip(\"Run Code (crtl + shift + enter)\", placement = \"bottom\"),\r\n            shiny::actionButton(\r\n              inputId = ns(\"Import\"),\r\n              label = NULL,\r\n              style = \"width: 45px; font-size: 80%; padding: 0px; border: 1px solid #f2f2f2; background-color: #3498db;\",\r\n              icon = shiny::icon(\r\n                \"file\"\r\n              )\r\n            ) %>%\r\n              bslib::tooltip(\"Import Data (crtl + i)\", placement = \"bottom\"),\r\n            shiny::actionButton(\r\n              inputId = ns(\"Remove\"),\r\n              label = NULL,\r\n              style = \"width: 45px; font-size: 80%; padding: 0px; border: 1px solid #f2f2f2; background-color: #e74c3c;\",\r\n              icon = shiny::icon(\r\n                \"remove\"\r\n              )\r\n            ) %>%\r\n              bslib::tooltip(\"Remove from Environment\", placement = \"bottom\")\r\n          )\r\n        )\r\n      ),\r\n      bslib::card_body(\r\n        style = \"padding: 0px;\",\r\n        shinyAce::aceEditor(\r\n          outputId = ns(\"Ace\"),\r\n          height = \"100%\",\r\n          showPrintMargin = FALSE,\r\n          mode = \"r\",\r\n          autoComplete = \"live\",\r\n          autoCompleters = c(\"static\", \"rlang\", \"snippet\"),\r\n          debounce = 1,\r\n          tabSize = 2,\r\n          selectionId = \"selection\",\r\n          placeholder = \"Write some R code to get started...\",\r\n          hotkeys = list(\r\n            run_code = list(\r\n              win = \"Ctrl-Shift-Enter\",\r\n              mac = \"CMD-SHIFT-ENTER\"\r\n            ),\r\n            run_code_selected = list(\r\n              win = \"Ctrl-Enter\",\r\n              mac = \"CMD-ENTER\"\r\n            )\r\n          )\r\n        ) \r\n      )\r\n    )\r\n  )\r\n  \r\n}\r\n\r\nserver_editor <- function(id=\"editor\", ide){\r\n  \r\n  shiny::moduleServer(\r\n    id,\r\n    function(input, output, session){\r\n      ns <- session$ns\r\n      \r\n      # reactives\r\n      .run_code <- shiny::reactive({\r\n        list(input$Ace_run_code, input$Run)\r\n      })\r\n      \r\n      #observe input state\r\n      shiny::observeEvent(.run_code(), {\r\n        message(\"Run Code\")\r\n        \r\n        run <- evals(txt = input$Ace, env = .GlobalEnv)\r\n        ide$evals <- run\r\n        ide$code <- input$Ace\r\n        ide$hash <- md5(input$Ace)\r\n        \r\n        viewer <- tryCatch(\r\n          lapply(run, function(v) if(any(v[[\"type\"]] == \"htmlwidget\")) shiny::tagList(v[[\"result\"]]) else NULL),\r\n          error = function(e) NULL\r\n        )\r\n        \r\n        message(viewer)\r\n        if(!is.null(viewer)){\r\n          viewer <- Filter(Negate(is.null), viewer)\r\n          message(viewer)\r\n          \r\n          if(length(viewer) > 0){\r\n            message(\"Update Viewer\")\r\n            message(viewer)\r\n            ide$view <- viewer \r\n              \r\n          }\r\n        }\r\n        \r\n      }, priority = 1, ignoreInit = TRUE)\r\n      \r\n      # ui outputs\r\n      shinyAce::aceAutocomplete(\r\n        inputId = \"Ace\",\r\n        session = session\r\n      )\r\n      \r\n      shinyAce::aceAnnotate(\r\n        inputId = \"Ace\",\r\n        session = session\r\n      )\r\n      \r\n      shinyAce::aceTooltip(\r\n        inputId = \"Ace\",\r\n        session = session\r\n      )\r\n      \r\n    }\r\n  )\r\n  \r\n}","type":"text"},{"name":"R/environment.R","content":"ui_environment <- function(id=\"environment\"){\r\n  ns <- shiny::NS(id)\r\n  \r\n  shiny::tagList(\r\n    shiny::fluidRow(\r\n      class = \"m-0\",\r\n      shiny::column(\r\n        width = 12,\r\n        style = \"padding: 0px;\",\r\n        shiny::fluidRow(\r\n          class = \"m-0\",\r\n          shiny::column(\r\n            width = 12,\r\n            style = \"padding: 0px; height: 50%;\",\r\n            reactable::reactableOutput(\r\n              outputId = ns(\"ls\")\r\n            )\r\n          ),\r\n          shiny::column(\r\n            width = 12,\r\n            style = \"padding: 0px;\",\r\n            reactable::reactableOutput(\r\n              outputId = ns(\"pak\")\r\n            )\r\n          )\r\n        )\r\n      )\r\n    )\r\n  )\r\n}\r\n\r\nserver_environment <- function(id=\"environment\", ide){\r\n  \r\n  shiny::moduleServer(\r\n    id,\r\n    function(input, output, session){\r\n      ns <- session$ns\r\n      \r\n      # reactives\r\n      envir_selected <- shiny::reactive({\r\n        select <- reactable::getReactableState(\"ls\", \"selected\")\r\n      })\r\n      \r\n      # observe inputs\r\n      observeEvent(envir_selected(), {\r\n        showModal(\r\n          modalDialog(\r\n            title = NULL,\r\n            footer = NULL,\r\n            shiny::fluidRow(\r\n              class = \"m-0\",\r\n              bslib::card(\r\n                height = \"65vh\",\r\n                style = \"padding: 0px;\",\r\n                full_screen = FALSE,\r\n                fill = TRUE,\r\n                bslib::card_header(\r\n                  style = \"padding: 0px; background-color: #eee;\",\r\n                  shiny::fluidRow(\r\n                    class = \"m-0\",\r\n                    shiny::actionButton(\r\n                      inputId = ns(\"envir_str\"),\r\n                      label = \"Structure\",\r\n                      style = \"width: 80px; font-size: 12px; padding: 0px; border: 1px solid #f2f2f2; background-color: #eee; color: black; font-weight: 600;\"\r\n                    ),\r\n                    shiny::actionButton(\r\n                      inputId = ns(\"envir_table\"),\r\n                      label = \"Table\",\r\n                      style = \"width: 80px; font-size: 12px; padding: 0px; border: 1px solid #f2f2f2; background-color: #eee; color: black; font-weight: 600;\"\r\n                    ),\r\n                    shiny::actionButton(\r\n                      inputId = ns(\"envir_list\"),\r\n                      label = \"List\",\r\n                      style = \"width: 80px; font-size: 12px; padding: 0px; border: 1px solid #f2f2f2; background-color: #eee; color: black; font-weight: 600;\"\r\n                    )\r\n                  )\r\n                ),\r\n                bslib::layout_sidebar(\r\n                  sidebar = bslib::sidebar(\r\n                    shiny::radioButtons(\r\n                      inputId = ns(\"envir_modal_sample\"),\r\n                      label = \"Sample Method\",\r\n                      choiceNames = c(\"Head\", \"Tail\", \"None\"),\r\n                      choiceValues = c(\"head\", \"tail\", \"none\")\r\n                    ),\r\n                    shiny::uiOutput(\r\n                      outputId = ns(\"envir_modal_sample_n\")\r\n                    ),\r\n                    fillable = TRUE,\r\n                    fill = TRUE\r\n                  ),\r\n                  bslib::card_body(\r\n                    style = \"padding: 0px;\",\r\n                    shiny::uiOutput(\r\n                      outputId = ns(\"envir_modal\")\r\n                    )\r\n                  )\r\n                )\r\n              )\r\n            ),\r\n            shiny::includeScript(\r\n              path = \"www/modal.js\"\r\n            ),\r\n            easyClose = TRUE,\r\n            size = \"xl\",\r\n            style = \"padding: 0px; margin: 0px;\"\r\n          )\r\n        )\r\n      })\r\n      \r\n      observeEvent(input$envir_str, {\r\n        ide$tab_modal <- \"structure\"\r\n      })\r\n      \r\n      observeEvent(input$envir_table, {\r\n        ide$tab_modal <- \"table\"\r\n      })\r\n      \r\n      observeEvent(input$envir_list, {\r\n        ide$tab_modal <- \"list\"\r\n      })\r\n      \r\n      # ui outputs\r\n      output$ls <- reactable::renderReactable({\r\n        if(!is.null(ide$envir)){\r\n          reactable::reactable(\r\n            ide$envir,\r\n            height = \"47.5vh\",\r\n            sortable = T,\r\n            resizable = T,\r\n            pagination = F,\r\n            highlight = T,\r\n            compact = T,\r\n            bordered = T,\r\n            onClick = \"select\",\r\n            selection = \"single\",\r\n            wrap = F,\r\n            columns = list(\r\n              .selection = colDef(show = FALSE)\r\n            ),\r\n            style = \"font-size: 13px; overflow-x: hidden;\",\r\n            defaultSorted = \"Class\",\r\n            theme = reactableTheme(\r\n              rowSelectedStyle = list(\r\n                backgroundColor = \"lightgrey\"\r\n              ),\r\n              headerStyle = list(\r\n                backgroundColor = \"rgb(246, 247, 249)\",\r\n                borderColor = \"black\"\r\n              )\r\n            )\r\n          )\r\n        }\r\n      })\r\n      \r\n      output$pak <- reactable::renderReactable({\r\n        if(!is.null(ide$pak)){\r\n          reactable::reactable(\r\n            ide$pak,\r\n            height = \"47.5vh\",\r\n            sortable = T,\r\n            resizable = T,\r\n            pagination = F,\r\n            highlight = T,\r\n            compact = T,\r\n            bordered = T,\r\n            onClick = \"select\",\r\n            selection = \"single\",\r\n            wrap = F,\r\n            columns = list(\r\n              .selection = colDef(show = FALSE)\r\n            ),\r\n            style = \"font-size: 13px; overflow-x: hidden;\",\r\n            defaultSorted = \"Package\",\r\n            theme = reactableTheme(\r\n              headerStyle = list(\r\n                backgroundColor = \"rgb(246, 247, 249)\",\r\n                borderColor = \"black\"\r\n              )\r\n            )\r\n          )\r\n        }\r\n      })\r\n      \r\n      output$envir_modal <- renderUI({\r\n        \r\n        if(input$envir_modal_sample == \"head\"){\r\n          shiny::req(input$n)\r\n          \r\n          d <- head(\r\n            get(\r\n              ide$envir[[\"Object\"]][envir_selected()],\r\n              envir = .GlobalEnv\r\n            ),\r\n            n = input$n\r\n          )\r\n        }else if(input$envir_modal_sample == \"tail\"){\r\n          shiny::req(input$n)\r\n          \r\n          d <- tail(\r\n            get(\r\n              ide$envir[[\"Object\"]][envir_selected()],\r\n              envir = .GlobalEnv\r\n            ),\r\n            n = input$n\r\n          )\r\n        }else{\r\n          d <- get(\r\n            ide$envir[[\"Object\"]][envir_selected()],\r\n            envir = .GlobalEnv\r\n          )\r\n        }\r\n        \r\n        if(ide$tab_modal == \"structure\"){\r\n          shiny::renderPrint({\r\n            str(d)\r\n          })\r\n        }else if(ide$tab_modal == \"table\"){\r\n          reactable(\r\n            d,\r\n            height = \"100%\",\r\n            width = \"100%\"\r\n          )\r\n        }else if(ide$tab_modal == \"list\"){\r\n          listviewer::jsonedit(\r\n            d,\r\n            height = \"100%\",\r\n            width = \"100%\"\r\n          )\r\n        }\r\n      })\r\n      \r\n      output$envir_modal_sample_n <- renderUI({\r\n        if(input$envir_modal_sample %in% c(\"head\", \"tail\")){\r\n          \r\n          shiny::numericInput(\r\n            inputId = ns(\"n\"),\r\n            label = \"N Rows\",\r\n            value = 100,\r\n            min = 0,\r\n            max = 10000\r\n          )\r\n          \r\n        }else if(input$envir_modal_sample == \"none\"){\r\n          \r\n        }\r\n        \r\n      })\r\n      \r\n    }\r\n  )\r\n  \r\n}","type":"text"},{"name":"R/explore.R","content":"ui_explore <- function(id=\"explore\"){\r\n  ns <- shiny::NS(id)\r\n  \r\n  shiny::tagList(\r\n    shiny::tags$div(\r\n      shiny::fluidRow(\r\n        class = \"m-0\",\r\n        style = \"height: 35px;\",\r\n        shiny::fluidRow(\r\n          shiny::column(\r\n            width = 1,\r\n            style = \"padding:5px; width: 15%;\",\r\n            shiny::actionButton(\r\n              inputId = ns(\"menu_data\"),\r\n              label = \"Data\",\r\n              width = \"100%\",\r\n              icon = shiny::icon(\r\n                name = \"table\"\r\n              ),\r\n              style = \"padding: 1px; font-size: 14px;\"\r\n            ),\r\n          ),\r\n          shiny::column(\r\n            width = 1,\r\n            style = \"padding:5px; width: 15%;\",\r\n            shiny::actionButton(\r\n              inputId = ns(\"menu_visual\"),\r\n              label = \"Visual\",\r\n              width = \"100%\",\r\n              icon = shiny::icon(\r\n                name = \"bar-chart\"\r\n              ),\r\n              style = \"padding: 1px; font-size: 14px;\"\r\n            ),\r\n          ),\r\n          shiny::column(\r\n            width = 1,\r\n            style = \"padding:5px; width: 15%;\",\r\n            shiny::actionButton(\r\n              inputId = ns(\"menu_model\"),\r\n              label = \"Model\",\r\n              width = \"100%\",\r\n              icon = shiny::icon(\r\n                name = \"lightbulb\"\r\n              ),\r\n              style = \"padding: 1px; font-size: 14px;\"\r\n            ),\r\n          )\r\n        )\r\n      ),\r\n      shiny::fluidRow(\r\n        class = \"m-0\",\r\n        style = \"height: calc(100vh - 61px);\",\r\n        bslib::card(\r\n          height = \"100%\",\r\n          style = \"padding: 0px;\",\r\n          full_screen = TRUE,\r\n          fill = TRUE,\r\n          bslib::card_header(\r\n            style = \"padding: 0px;\",\r\n            shiny::uiOutput(\r\n              outputId = ns(\"bi_header\")\r\n            ) \r\n          ),\r\n          bslib::layout_sidebar(\r\n            sidebar = bslib::sidebar(\r\n              shiny::uiOutput(\r\n                outputId = ns(\"bi_sidebar\")\r\n              ),\r\n              fillable = TRUE,\r\n              fill = TRUE\r\n            ),\r\n            bslib::card_body(\r\n              style = \"padding: 0px;\",\r\n              shiny::uiOutput(\r\n                outputId = ns(\"bi_content\")\r\n              )\r\n            )\r\n          )\r\n        )\r\n      )\r\n    ),\r\n    shiny::includeScript(\r\n      path = \"www/bi.js\"\r\n    )\r\n  )\r\n  \r\n}\r\n\r\nserver_explore <- function(id=\"explore\", ide){\r\n  \r\n  shiny::moduleServer(\r\n    id,\r\n    function(input, output, session){\r\n      ns <- session$ns\r\n      \r\n      # reactives\r\n      df_selected <- shiny::reactive({\r\n        select <- reactable::getReactableState(\"bi_dataframes\", \"selected\")\r\n      })\r\n      \r\n      data <- shiny::reactive({\r\n        shiny::req(df_selected())\r\n        \r\n        df <- get(ide$df[df_selected(), ])\r\n        ide$df_vars <- colnames(df)\r\n        return(df)\r\n      })\r\n      \r\n      # observe input state\r\n      shiny::observeEvent(input$menu_data, {\r\n        ide$menu <- \"data\"\r\n      })\r\n      \r\n      shiny::observeEvent(input$menu_visual, {\r\n        ide$menu <- \"visual\"\r\n      })\r\n      \r\n      shiny::observeEvent(input$menu_model, {\r\n        ide$menu <- \"model\"\r\n      })\r\n      \r\n      shiny::observeEvent(df_selected(), {\r\n        ide$df_selected <- df_selected()\r\n      })\r\n      \r\n      shiny::observeEvent(input$add_visual, {\r\n        shiny::insertUI(\r\n          selector = paste0(\"#\", ns(\"add_visual\")),\r\n          where = \"afterEnd\",\r\n          ui = shiny::tagList(\r\n            shiny::actionButton(\r\n              inputId = \"viz2\",\r\n              label = \"Viz-2\",\r\n              style = \"width: 10%; font-size: 80%; padding: 0px; border: 1px solid white;\"\r\n            )\r\n          )\r\n        )\r\n      })\r\n      \r\n      shiny::observeEvent(input$add_model, {\r\n        shiny::insertUI(\r\n          selector = paste0(\"#\", ns(\"add_model\")),\r\n          where = \"afterEnd\",\r\n          ui = shiny::tagList(\r\n            shiny::actionButton(\r\n              inputId = \"mod2\",\r\n              label = \"Mod-2\",\r\n              style = \"width: 10%; font-size: 80%; padding: 0px; border: 1px solid white;\"\r\n            )\r\n          )\r\n        )\r\n      })\r\n      \r\n      # ui outputs\r\n      output$bi_header <- shiny::renderUI({\r\n        \r\n        if(ide$menu == \"data\"){\r\n          \r\n          shiny::tagList(\r\n            shiny::fluidRow(\r\n              class = \"m-0\",\r\n              shiny::actionButton(\r\n                inputId = ns(\"data_tab_table\"),\r\n                label = \"Table\",\r\n                style = \"width: 10%; font-size: 12px; padding: 0px; border: 1px solid white;\"\r\n              )\r\n            )\r\n          )\r\n          \r\n        }else if(ide$menu == \"visual\"){\r\n          \r\n          shiny::tagList(\r\n            shiny::fluidRow(\r\n              class = \"m-0\",\r\n              shiny::actionButton(\r\n                inputId = ns(\"add_visual\"),\r\n                label = NULL,\r\n                style = \"width: 10%; font-size: 12px; padding: 0px; border: 1px solid white;\",\r\n                icon = shiny::icon(\r\n                  \"plus\"\r\n                )\r\n              ),\r\n              shiny::actionButton(\r\n                inputId = ns(\"viz1\"),\r\n                label = \"Viz-1\",\r\n                style = \"width: 10%; font-size: 12px; padding: 0px; border: 1px solid white;\"\r\n              )\r\n            )\r\n          )\r\n          \r\n        }else if(ide$menu == \"model\"){\r\n          \r\n          shiny::tagList(\r\n            shiny::fluidRow(\r\n              class = \"m-0\",\r\n              shiny::actionButton(\r\n                inputId = ns(\"add_model\"),\r\n                label = NULL,\r\n                style = \"width: 10%; font-size: 12px; padding: 0px; border: 1px solid white;\",\r\n                icon = shiny::icon(\r\n                  \"plus\"\r\n                )\r\n              ),\r\n              shiny::actionButton(\r\n                inputId = ns(\"mod1\"),\r\n                label = \"Mod-1\",\r\n                style = \"width: 10%; font-size: 12px; padding: 0px; border: 1px solid white;\"\r\n              )\r\n            )\r\n          )\r\n          \r\n        }\r\n        \r\n      })\r\n      \r\n      output$bi_sidebar <- shiny::renderUI({\r\n        \r\n        if(ide$menu == \"data\"){\r\n          shiny::tagList(\r\n            reactable::reactableOutput(\r\n              outputId = ns(\"bi_dataframes\")\r\n            )\r\n          )\r\n        }else if (ide$menu == \"visual\"){\r\n          shiny::tagList(\r\n            shiny::selectizeInput(\r\n              inputId = \"select_plot\",\r\n              label = \"Choose a Visual\",\r\n              choices = list(\r\n                `Table` = c(\"Pivot Table\", \"Table\"),\r\n                `Distribution` = c(\"Histogram\", \"Density\", \"Boxplot\", \"Word Cloud\", \"Probability Plot\"),\r\n                `Aggregate` = c(\"Barplot\", \"Stacked Barplot\", \"3D Barplot\", \"Heatmap\", \"Radar\", \"Piechart\", \"Donut\", \"Rosetype\"),\r\n                `Time Series` = c(\"Line\", \"Area\", \"Step\", \"River\", \"Autocorrelation\", \"Partial Autocorr\"),\r\n                `Relationship` = c(\"Correlogram\", \"Parallel\", \"Scatter\", \"3D Scatter\", \"Copula\", \"3D Copula\"),\r\n                `Evaluation` = c(\"Residuals\", \"Residuals Scatter\", \"Partial Dependence Line\", \"Partial Dependence Heatmap\", \"Calibration Line\", \"Calibration Boxplot\", \"Variable Importance\", \"Shapley Importance\", \"ROC Plot\", \"Confusion Matrix\", \"Gains\", \"Lift\")\r\n              ),\r\n              options = list(placeholder = \"Visual Type...\"),\r\n              selected = \"Line\",\r\n              multiple = FALSE\r\n            ),\r\n            shiny::uiOutput(\"bi_plots\")\r\n          )\r\n        }else if(ide$menu == \"model\"){\r\n          shiny::tags$h3(\"model\")\r\n        }\r\n        \r\n        \r\n      })\r\n      \r\n      output$bi_content <- shiny::renderUI({\r\n        \r\n      })\r\n      \r\n      output$bi_dataframes <- reactable::renderReactable({\r\n        # shiny::req(ide$df_selected)\r\n        if(!is.null(ide$df)){\r\n          reactable::reactable(\r\n            data = ide$df,\r\n            minRows = 10,\r\n            height = \"45vh\",\r\n            searchable = TRUE,\r\n            highlight = TRUE,\r\n            onClick = \"select\",\r\n            selection = \"single\",\r\n            pagination = FALSE,\r\n            pageSizeOptions = 10,\r\n            wrap = FALSE,\r\n            compact = TRUE,\r\n            borderless = FALSE,\r\n            defaultSelected = df_selected(),\r\n            language = reactableLang(\r\n              searchPlaceholder = \"Search...\",\r\n              noData = \"No Match\",\r\n            ),\r\n            theme = reactableTheme(\r\n              color = \"black\",\r\n              backgroundColor = \"#f2f2f2\",\r\n              rowSelectedStyle = list(\r\n                backgroundColor = \"lightgrey\"\r\n              ),\r\n              headerStyle = list(\r\n                borderColor = \"black\",\r\n                textAlign = \"left\"\r\n              ),\r\n              searchInputStyle = list(\r\n                color = \"black\",\r\n                backgroundColor = \"#ADD6FF26\",\r\n                width = \"100%\"\r\n              )\r\n            ),\r\n            columns = list(\r\n              DataFrames = colDef(name = \"Data Frames\"),\r\n              .selection = colDef(show = FALSE)\r\n            ),\r\n            defaultColDef = colDef(align = \"left\")\r\n          )\r\n        }\r\n        \r\n      })\r\n      \r\n      \r\n    }\r\n  )\r\n}","type":"text"},{"name":"R/global.R","content":"# shiny\r\nlibrary(shiny)\r\nlibrary(bslib)\r\nlibrary(shinyAce)\r\nlibrary(shinylive)\r\nlibrary(shinybusy)\r\nlibrary(shinyjs)\r\n# data\r\nlibrary(pander)\r\nlibrary(dplyr)\r\nlibrary(tidyr)\r\nlibrary(formatR)\r\nlibrary(jsonlite)\r\nlibrary(openssl)\r\n# visual\r\nlibrary(reactable)\r\nlibrary(listviewer)\r\n# components\r\nsource(\"R/editor.R\")\r\nsource(\"R/controls.R\")\r\nsource(\"R/console.R\")","type":"text"},{"name":"R/viewer.R","content":"ui_viewer <- function(id=\"viewer\"){\r\n  ns <- shiny::NS(id)\r\n  \r\n  shiny::tagList(\r\n    shiny::fluidRow(\r\n      class = \"m-0\",\r\n      shiny::column(\r\n        width = 12,\r\n        style = \"padding: 0px;\",\r\n        shiny::uiOutput(\r\n          outputId = ns(\"viewer\")\r\n        )\r\n      )\r\n    )\r\n  )\r\n}\r\n\r\nserver_viewer <- function(id=\"viewer\", ide){\r\n  \r\n  shiny::moduleServer(\r\n    id,\r\n    function(input, output, session){\r\n      ns <- session$ns\r\n      \r\n      output$viewer <- renderUI({\r\n        lapply(seq_along(ide$view), function(widget){\r\n          bslib::card(\r\n            ide$view[[widget]],\r\n            fill = TRUE,\r\n            full_screen = TRUE,\r\n            style = \"padding: 0px; margin: 0px;\"\r\n          )\r\n        })\r\n      })\r\n      \r\n    }\r\n  )\r\n  \r\n}","type":"text"},{"name":"www/bi.js","content":"$(document).ready(function() {\r\n  var activeMenuId = 'explore-menu_data';\r\n  $('#explore-menu_data, #explore-menu_visual, #explore-menu_model, #explore-menu_step').click(function() {\r\n    $('#' + activeMenuId).removeClass('active-menu');\r\n    $(this).addClass('active-menu');\r\n    activeMenuId = $(this).attr('id');\r\n  });\r\n  $('#explore-menu_data').click();\r\n});","type":"text"},{"name":"www/custom.js","content":"Split(['#pane-code', '#pane-control'], {\r\n  direction: 'horizontal',\r\n  minSize: 200\r\n});\r\n\r\nSplit(['#pane-editor', '#pane-console'], {\r\n  direction: 'vertical',\r\n  minSize: 100\r\n});\r\n\r\n$(document).ready(function() {\r\n  var activeTabId = 'controls-tab_environment';\r\n  $('#controls-tab_environment, #controls-tab_viewer, #controls-tab_explore').click(function() {\r\n    $('#' + activeTabId).removeClass('active-tab');\r\n    $(this).addClass('active-tab');\r\n    activeTabId = $(this).attr('id');\r\n  });\r\n  $('#controls-tab_environment').click();\r\n});\r\n\r\n\r\n","type":"text"},{"name":"www/modal.js","content":"$(document).ready(function() {\r\n  var activeModalId = 'environment-envir_str';\r\n  $('#environment-envir_str, #environment-envir_table, #environment-envir_list').click(function() {\r\n    $('#' + activeModalId).removeClass('active-tab');\r\n    $(this).addClass('active-tab');\r\n    activeModalId = $(this).attr('id');\r\n  });\r\n  $('#environment-envir_str').click();\r\n});","type":"text"},{"name":"www/style.css","content":"::-webkit-scrollbar {\r\n  width: 7px !important;\r\n  height: 7px !important;\r\n}\r\n      \r\n::-webkit-scrollbar-track {\r\n  background: #f1f1f1 !important; \r\n}\r\n       \r\n::-webkit-scrollbar-thumb {\r\n  background: #888 !important; \r\n}\r\n      \r\n::-webkit-scrollbar-thumb:hover {\r\n  background: #555 !important; \r\n}\r\n      \r\n.split {\r\n  display: flex;\r\n  flex-direction: row;\r\n  height: 100vh;\r\n  width: 100%;\r\n}\r\n      \r\n.gutter {\r\n  background-color: rgb(246, 247, 249);\r\n  background-repeat: no-repeat;\r\n  background-position: 50%;      \r\n}\r\n      \r\n.gutter.gutter-horizontal {\r\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');\r\n  cursor: col-resize;\r\n}\r\n\r\n.active-tab {\r\n  background-color: rgb(246, 247, 249) !important; \r\n  color: black !important; \r\n  font-weight: 900 !important; \r\n  border-bottom: 1.5px solid black !important;\r\n}\r\n\r\n.active-menu {\r\n  background-color: #f2f2f2 !important; \r\n  color: black !important; \r\n  font-weight: bold !important; \r\n  border-bottom: 1px solid black !important;\r\n}\r\n      \r\n.active-tab:hover {\r\n  background-color: rgb(246, 247, 249) !important; \r\n  color: black !important; \r\n  font-weight: 900 !important; \r\n  border-bottom: 1.5px solid black !important;\r\n}\r\n\r\n.active-menu:hover {\r\n  background-color: #f2f2f2 !important; \r\n  color: black !important; \r\n  font-weight: bold !important; \r\n  border-bottom: 1px solid black !important;\r\n}\r\n\r\n.r-src {\r\n  white-space: pre;\r\n  font-family: 'Consolas', monospace;\r\n  color: blue;\r\n} \r\n      \r\n.r-message {\r\n  white-space: pre;\r\n  font-family: 'Consolas', monospace;\r\n  color: #3498db;\r\n  font-weight: bold;\r\n}\r\n\r\n.r-warning {\r\n  white-space: pre;\r\n  font-family: 'Consolas', monospace;\r\n  color: #E4A11B;\r\n  font-weight: bold;\r\n}\r\n       \r\n.r-error {\r\n  white-space: pre;\r\n  font-family: 'Consolas', monospace;\r\n  color: #e74c3c;\r\n  font-weight: bold;\r\n}\r\n\r\n.r-output {\r\n  white-space: pre;\r\n  font-family: 'Consolas', monospace;\r\n  color: black;\r\n}","type":"text"}]
